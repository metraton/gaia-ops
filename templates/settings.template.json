{
  "system_prompt": "You are part of an intelligent DevOps agent system. Use specialized agents via the Task tool for complex operations. Development mode with tiered security: read operations allowed, destructive operations require approval, highly destructive operations blocked.",

  "hooks": {
    "PreToolUse": [
      {
        "matcher": "BashTool",
        "hooks": [
          {
            "type": "command",
            "command": ".claude/hooks/pre_tool_use.py"
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "BashTool",
        "hooks": [
          {
            "type": "command",
            "command": ".claude/hooks/post_tool_use.py"
          }
        ]
      }
    ],
    "SubagentStop": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": ".claude/hooks/subagent_stop.py"
          }
        ]
      }
    ]
  },

  "permissions": {
    "allow": [
      "Read",
      "Glob",
      "Grep",
      "Task",
      "SlashCommand",
      "Skill",
      "TodoWrite",
      "AskUserQuestion",
      "ExitPlanMode",
      "BashOutput",
      "KillShell",
      "mcp__ide__getDiagnostics",
      "mcp__ide__executeCode",
      "WebSearch",
      "WebFetch",

      "Bash(kubectl get:*)",
      "Bash(kubectl describe:*)",
      "Bash(kubectl logs:*)",
      "Bash(kubectl explain:*)",
      "Bash(kubectl version:*)",
      "Bash(kubectl config:*)",
      "Bash(kubectl top:*)",
      "Bash(kubectl wait:*)",
      "Bash(kubectl run:*)",

      "Bash(flux check:*)",
      "Bash(flux get:*)",
      "Bash(flux version:*)",

      "Bash(helm list:*)",
      "Bash(helm status:*)",
      "Bash(helm version:*)",
      "Bash(helm template:*)",
      "Bash(helm lint:*)",

      "Bash(git status:*)",
      "Bash(git log:*)",
      "Bash(git diff:*)",
      "Bash(git show:*)",
      "Bash(git branch:*)",
      "Bash(git init:*)",

      "Bash(gcloud version:*)",
      "Bash(gcloud config:*)",
      "Bash(gcloud auth:*)",
      "Bash(gcloud projects list:*)",
      "Bash(gcloud container clusters get-credentials:*)",
      "Bash(gcloud container clusters describe:*)",
      "Bash(gcloud container clusters list:*)",
      "Bash(gcloud sql instances describe:*)",
      "Bash(gcloud sql instances list:*)",
      "Bash(gcloud builds submit:*)",
      "Bash(gcloud compute instances list:*)",
      "Bash(gcloud compute instances describe:*)",
      "Bash(gcloud compute.*describe:*)",
      "Bash(gcloud compute.*list:*)",
      "Bash(gcloud storage.*list:*)",
      "Bash(gcloud iam.*list:*)",
      "Bash(gcloud iam.*describe:*)",
      "Bash(gcloud logging read:*)",
      "Bash(gsutil ls:*)",

      "Bash(terraform version:*)",
      "Bash(terraform fmt:*)",
      "Bash(terraform validate:*)",
      "Bash(terraform show:*)",
      "Bash(terraform output:*)",

      "Bash(aws s3 ls:*)",
      "Bash(aws s3api get-:*)",
      "Bash(aws s3api list-:*)",
      "Bash(aws s3api head-object:*)",
      "Bash(aws ec2 describe-:*)",
      "Bash(aws ec2 get-:*)",
      "Bash(aws rds describe-:*)",
      "Bash(aws rds list-:*)",
      "Bash(aws iam list-:*)",
      "Bash(aws iam get-:*)",
      "Bash(aws lambda list-functions:*)",
      "Bash(aws lambda get-function:*)",
      "Bash(aws cloudformation describe-:*)",
      "Bash(aws cloudformation get-template:*)",
      "Bash(aws cloudwatch describe-:*)",
      "Bash(aws cloudwatch get-metric:*)",
      "Bash(aws cloudwatch list-:*)",
      "Bash(aws logs describe-:*)",
      "Bash(aws logs get-log-events:*)",
      "Bash(aws sts get-caller-identity:*)",

      "Bash(docker ps:*)",
      "Bash(docker images:*)",
      "Bash(docker inspect:*)",
      "Bash(docker history:*)",
      "Bash(docker logs:*)",
      "Bash(docker stats:*)",
      "Bash(docker top:*)",
      "Bash(docker volume ls:*)",
      "Bash(docker network ls:*)",
      "Bash(docker version:*)",
      "Bash(docker info:*)",
      "Bash(docker system df:*)",

      "Bash(ls:*)",
      "Bash(pwd:*)",
      "Bash(cd:*)",
      "Bash(cat:*)",
      "Bash(head:*)",
      "Bash(tail:*)",
      "Bash(grep:*)",
      "Bash(find:*)",
      "Bash(which:*)",
      "Bash(echo:*)",
      "Bash(printf:*)",
      "Bash(python3:*)",
      "Bash(node:*)",
      "Bash(npm:*)",
      "Bash(sudo service docker status:*)",
      "Bash(docker info:*)",
      "Bash(curl:*)",
      "Bash(sed:*)"
    ],

    "deny": [
      "Bash(gcloud container clusters delete:*)",
      "Bash(gcloud sql instances delete:*)",
      "Bash(gcloud projects delete:*)",
      "Bash(gcloud compute instances delete:*)",
      "Bash(gcloud services disable:*)",
      "Bash(gcloud compute firewall-rules delete:*)",
      "Bash(gcloud compute networks delete:*)",
      "Bash(gsutil rm.*-r:*)",
      "Bash(gsutil rb:*)",

      "Bash(kubectl drain:*)",
      "Bash(kubectl cordon:*)",
      "Bash(kubectl uncordon:*)",

      "Bash(terraform destroy:*)",
      "Bash(terragrunt destroy:*)",

      "Bash(aws ec2 terminate-instances:*)",
      "Bash(aws rds delete-db-instance:*)",
      "Bash(aws rds delete-db-cluster:*)",
      "Bash(aws iam delete-:*)",
      "Bash(aws iam.*delete.*policy:*)",
      "Bash(aws cloudformation delete-stack:*)",
      "Bash(aws lambda delete-function:*)",
      "Bash(aws s3.*rb :*)",
      "Bash(aws s3 rm.*--recursive:*)",

      "Bash(docker rm:*)",
      "Bash(docker rmi:*)",
      "Bash(docker volume rm:*)",
      "Bash(docker network rm:*)",
      "Bash(docker system prune.*--all:*)",
      "Bash(docker container prune:*)",
      "Bash(docker image prune.*--all:*)",
      "Bash(docker compose down.*--volumes:*)",

      "Bash(dd:*)",
      "Bash(mkfs:*)",
      "Bash(fdisk:*)"
    ],

    "ask": [
      "Edit",
      "Write",
      "NotebookEdit",

      "Bash(kubectl delete:*)",
      "Bash(kubectl rollout:*)",
      "Bash(kubectl scale:*)",
      "Bash(kubectl patch:*)",
      "Bash(kubectl create:*)",
      "Bash(kubectl apply:*)",
      "Bash(kubectl replace:*)",
      "Bash(kubectl exec:*)",

      "Bash(flux delete:*)",
      "Bash(flux reconcile:*)",
      "Bash(flux create:*)",
      "Bash(flux suspend:*)",
      "Bash(flux resume:*)",

      "Bash(helm install:*)",
      "Bash(helm upgrade:*)",
      "Bash(helm uninstall:*)",
      "Bash(helm delete:*)",
      "Bash(helm rollback:*)",

      "Bash(git commit:*)",
      "Bash(git push:*)",
      "Bash(git merge:*)",
      "Bash(git rebase:*)",
      "Bash(git cherry-pick:*)",
      "Bash(git add:*)",

      "Bash(terraform plan:*)",
      "Bash(terraform apply:*)",
      "Bash(terragrunt plan:*)",
      "Bash(terragrunt apply:*)",

      "Bash(rm:*)",
      "Bash(rmdir:*)",
      "Bash(mv:*)",
      "Bash(cp:*)",
      "Bash(chmod:*)",
      "Bash(chown:*)",

      "Bash(aws.*--dryrun:*)",
      "Bash(aws s3 mb:*)",
      "Bash(aws s3 cp:*)",
      "Bash(aws s3api put-:*)",
      "Bash(aws ec2 run-instances:*)",
      "Bash(aws ec2 create-:*)",
      "Bash(aws ec2 modify-:*)",
      "Bash(aws ec2 start-instances:*)",
      "Bash(aws ec2 stop-instances:*)",
      "Bash(aws ec2 reboot-instances:*)",
      "Bash(aws ec2 authorize-security-group:*)",
      "Bash(aws rds create-:*)",
      "Bash(aws rds modify-:*)",
      "Bash(aws iam create-:*)",
      "Bash(aws iam attach-:*)",
      "Bash(aws iam put-:*)",
      "Bash(aws lambda create-function:*)",
      "Bash(aws lambda update-:*)",
      "Bash(aws cloudformation create-stack:*)",
      "Bash(aws cloudformation update-stack:*)",

      "Bash(gcloud.*--dryrun:*)",
      "Bash(gcloud compute instances create:*)",
      "Bash(gcloud compute instances stop:*)",
      "Bash(gcloud compute instances start:*)",
      "Bash(gcloud compute instances reset:*)",
      "Bash(gcloud compute.*create:*)",
      "Bash(gcloud compute.*update:*)",
      "Bash(gcloud container clusters create:*)",
      "Bash(gcloud container clusters update:*)",
      "Bash(gcloud container node-pools create:*)",
      "Bash(gcloud sql instances create:*)",
      "Bash(gcloud sql instances patch:*)",
      "Bash(gcloud sql databases create:*)",
      "Bash(gsutil mb:*)",
      "Bash(gsutil cp:*)",
      "Bash(gcloud functions deploy:*)",

      "Bash(docker build:*)",
      "Bash(docker run:*)",
      "Bash(docker commit:*)",
      "Bash(docker start:*)",
      "Bash(docker stop:*)",
      "Bash(docker restart:*)",
      "Bash(docker pause:*)",
      "Bash(docker unpause:*)",
      "Bash(docker rename:*)",
      "Bash(docker cp:*)",
      "Bash(docker tag:*)",
      "Bash(docker push:*)",
      "Bash(docker pull:*)",
      "Bash(docker volume create:*)",
      "Bash(docker network create:*)",
      "Bash(docker network connect:*)",
      "Bash(docker compose up:*)",
      "Bash(docker compose down:*)",
      "Bash(docker compose stop:*)",
      "Bash(docker compose start:*)",
      "Bash(docker compose restart:*)"
    ]
  },

  "security": {
    "default_tier": "T0",
    "tier_definitions": {
      "T0": {
        "name": "Read Only",
        "description": "Query and information commands allowed without approval",
        "blocked": false
      },
      "T1": {
        "name": "Validation",
        "description": "Validation and planning operations allowed without approval",
        "blocked": false
      },
      "T2": {
        "name": "Reversible - Ask",
        "description": "Reversible operations require user approval",
        "blocked": false
      },
      "T3": {
        "name": "Highly Destructive - Blocked",
        "description": "Highly destructive operations blocked automatically",
        "blocked": true
      }
    },
    "always_blocked": [
      "gcloud container clusters delete",
      "gcloud sql instances delete",
      "gcloud projects delete",
      "gcloud compute instances delete",
      "gcloud services disable",
      "gcloud compute firewall-rules delete",
      "gcloud compute networks delete",
      "gsutil rm.*-r",
      "gsutil rb",
      "terraform destroy",
      "terragrunt destroy",
      "git push.*--force",
      "git push.*-f ",
      "git reset.*--hard",
      "kubectl drain",
      "rm -rf /",
      "dd if=",
      "mkfs\\.",
      "fdisk",
      "aws ec2 terminate-instances",
      "aws rds delete-db-instance",
      "aws rds delete-db-cluster",
      "aws iam delete-",
      "aws cloudformation delete-stack",
      "aws lambda delete-function",
      "aws s3.*rb",
      "docker rm",
      "docker rmi",
      "docker volume rm",
      "docker network rm",
      "docker system prune.*--all",
      "docker compose down.*--volumes"
    ]
  },

  "environment": {
    "mode": "development"
  }
}
